{
	"is_virtualbox_available": true,
	"virtual_machine_setup": [
		{
			"phase": "Setup virtual machine",
			"steps": {
				"ubunt_server_vm_exists": false,
				"create_new_vm": "Enter 'New'",
				"vm_name": "Ubuntu Server",
				"vm_folder": "D:\\VirtualMachines\\VirtualBox",
				"iso_image": "D:\\VirtualMachines\\_iso_files\\ubuntu-22.04.4-live-server-amd64.iso",
				"username": "nara-us",
				"password": "$1234",
				"repeat_password": "$1234",
				"hostname": "Ubuntu-Server",
				"domain_name": "UNCHANGED",
				"base_memory_mb": 2048,
				"processors": 2,
				"virtual_disk_size_gb": 8.16,
				"finally": "Enter 'Finish'"
			}
		},
		{
			"phase": "Setup Ubuntu server in VM",
			"steps": {
				"run_virtual_machine": "Double click 'Ubuntu Server' instance",
				"language": "English",
				"keyboard_layout": "English (US)",
				"keyboard_variant": "English (US)",
				"base_installation": "Ubuntu Server",
				"network_connection": "enp0s3",
				"proxy_address": null,
				"default_ubuntu_archive_mirror": "PASS",
				"guided_storage_layout": {
					"use_an_entire_disk": true,
					"setup_disk_as_lvm_group": true,
					"encrypt_lvm_with_luks": false
				},
				"storage_configuration": "UNCHANGED",
				"begin_installation": "Enter 'Done'",
				"confirm_destruction_action": "Enter 'Continue'",
				"profile_setup": {
					"name": "Nara",
					"server_name": "nara-us",
					"username": "nara",
					"password": "$4321",
					"confirm_password": "$4321"
				},
				"upgrade_to_ubuntu_pro": false,
				"ssh_setup": {
					"install_openssh_server": true,
					"import_ssh_identity": "No"
				},
				"server_features": "SKIP",
				"reboot": "Enter 'Reboot Now'"
			}
		},
		{
			"phase": "Check newly set Ubuntu Server",
			"steps": {
				"run_virtual_machine": "Boot up from previous setup reboot",
				"nara-us_login": "nara",
				"password": "$4321",
				"is_logged_in_properly": true,
				"shutdown": "shutdown -h now"
			}
		}
	],
	"clone_and_configure_vm": [
		{
			"phase": "Cloning the Ubuntu Server instance",
			"steps": {
				"enter_cloning_dialog": "Right click the VM instance and hit 'Clone'",
				"vm_name": "Ubuntu Server Clone",
				"vm_path": "D:\\VirtualMachines\\VirtualBox",
				"mac_address_policy": "Include only NAT network adapter MAC addresses",
				"additional_options": {
					"keep_disk_names": false,
					"keep_hardware_uuids": false,
				},
				"clone_type": "Full clone"
			}
		},
		{
			"phase": "Configure profile settings",
			"steps": {
				"run_virtual_machine": "Double click 'Ubuntu Server Clone' instance",
				"nara-us_login": "nara",
				"password": "$4321",
				"is_logged_in_properly": true,
				"change_hostname_file": {
					"open_file": "sudo nano /etc/hostname",
					"changes": {
						"nara-us": "nara-us2"
					},
					"exit": "CTRL + X",
					"save_modified_buffer": "y",
					"file_name_to_write": "/etc/hostname"
				},
				"change_host_file": {
					"open_file": "sudo nano /etc/hosts",
					"changes": {
						"127.0.1.1 nara-us": "127.0.1.1 website" 
					},
					"exit": "CTRL + X",
					"save_modified_buffer": "y",
					"file_name_to_write": "/etc/hosts"
				},
				"change_user_password": {
					"action": "sudo passwd nara",
					"new_password": "$1234"
				},
				"add_new_user": {
					"action": "sudo adduser orca",
					"sudo_password": "$1234",
					"password": "1234",
					"confirm_password": "1234",
					"full_name": "Orca",
					"room_number": "SKIP",
					"work_phone": "SKIP",
					"home_phone": "SKIP",
					"other": "SKIP",
					"is_information_correct": "y"
				},
				"reboot": "reboot",
				"hostname_changed": true,
				"nara-us2_login": "nara",
				"password": "$1234",
				"is_logged_in_properly": true,
				"shutdown": "shutdown -h now"
			}
		},
		{
			"phase": "Check new user",
			"steps": {
				"run_virtual_machine": "Double click 'Ubuntu Server Clone' instance",
				"nara-us_login": "orca",
				"password": "1234",
				"is_logged_in_properly": true,
				"check_users_in_home_folder": "dir /home",
				"user_folder_exists": true,
				"grant_root_access_to_new_user": {
					"logout_from_orca": "logout",
					"nara-us_login": "nara",
					"password": "$4321",
					"grant_root_access": "sudo usermod -aG sudo orca"
				},
				"check_sudo_access": "groups orca",
				"is_orca_sudo": true
			}
		}
	],
	"configure_vm_connections": [
		{
			"phase": "Create NAT network in VirtualBox for SSH",
			"steps": {
				"open_nat_networks_panel": "Click 'Tools' button",
				"create_nat_network": "Click 'Create' button",
				"name": "netnat",
				"ipv4_profile": "172.91.1.0/24",
				"confirm_changes": "Click 'Apply'",
				"setup_port_forwarding": {
					"open_port_forwarding": "Click 'Port Forwarding'",
					"add_new_port_rule": "Click 'Adds new port forwarding rule'",
					"configure_rule": {
						"name": "ssh",
						"protocol": "TCP",
						"host_ip": "0.0.0.0",
						"host_port": "91",
						"guest_ip": "172.16.91.12",
						"guest_port": "22"
					}
				},
				"confirm_changes": "Click 'Apply'"
			}
		},
		{
			"phase": "Set network adapter for each VM in VirtualBox",
			"steps": {
				"open_settings": "Right click VM instance > Click 'Settings'",
				"open_network_tab": "Click 'Network'",
				"change_adapter_settings": {
					"enable_network_adapter": true,
					"attached_to": "NAT Network",
					"name": "netnat"
				},
				"confirm_changes": "Click 'Ok'"
			}
		},
		{
			"phase": "Set netplan network for each VM in VirtualBox",
			"steps": {
				"run_virtual_machine": "Double click VM instance",
				"enter_credentials": "Enter username and password",
				"change_netplan_yaml": {
					"open_file": "sudo nano /etc/netplan/00-installer-config.yaml",
					"changes": {
						"network": {
							"ethernets": {
								"enp0s3": {
									"dhcp4": false,
									"addresses": "[172.16.91.x/24] (x is specific ip)",
									"routes": {
										"- to": "0.0.0.0/0",
										"  via": "172.16.91.x (x is specific ip)"
									},
									"nameservers": {
										"addresses": "[8.8.8.8, 8.8.4.4]"
									}
								}
							},
						},
						"version": 2
					},
					"save_then_exit": "CTRL + S, CTRL + X"
				},
			}
		},
		{
			"phase": "Ping between VMs",
			"steps": {
				"run_virtual_machine": "Double click VM instance",
				"enter_credentials": "Enter username and password",
				"ping_vm": "ping 172.16.91.x (x is specific ip)",
				"is_ping_successful": true
			}
		}
	],
	"connect_with_ssh": [
		{
			"phase": "Connect with SSH from windows",
			"steps": {
				"is_vm_running": true,
				"open_cmd": "Open 'Command Prompt'",
				"initiate_connection": "ssh -p 91 orca@localhost",
				"enter_password": "1234",
				"is_logged_in_properly": true
			}
		}
	]
}